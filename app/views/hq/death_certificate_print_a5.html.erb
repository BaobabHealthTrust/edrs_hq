<!DOCTYPE HTML>
<html>
<head>
  <title>eDRS Death Certificate</title>
  <style>
 @media all {  
 body {
          margin: 0;
          -moz-user-select: none;
          font-family: "Nimbus Sans L", "Arial Narrow", sans-serif;
          margin-left: 10px;
          margin-right: 10px;
          color: #000;
          font-size: 20px;
         
        
      }
    
    #mainc {
    height: 100% !important;
    
    }  
      #barcode {
        margin-right: 0px;
        padding-right: 0px;
        padding-top: 0px;
        margin-top: 30px;
        float: right !important;
        
      }
      
      #childdata {
       clear: both;
       width: 21cm;
       margin-top: 38cm;
       padding-top: 6cm;
       margin-left: auto;
       margin-right: auto;
       height: 20cm;	
       }}
   
  </style>
</head>
<body style="color: #000;">
   <% @long_cert = false %>
   <% raw = File.read("#{CONFIG['barcodes_path']}#{@person.id}.png")

       @data = Base64.encode64(raw)

    %>
    
    <% raw_sig = File.read(Rails.root.join("public","uploads",User.find(GlobalProperty.find("signatory").value).signature)) rescue nil %>        
    <% if raw_sig
      @sig = Base64.encode64(raw_sig)
     end %>
             
<div id="mainc">             
  <div id="barcode">
    <p style="text-align: center !important;font-size: 12px;"><img src ="data:image/png;base64,<%= @data%>" />
    <br/><%= @person.npid %></p>
  </div>

<div id="childdata">

<table style="width: 21cm; font-weight: normal;" cellpadding="8" width="100%">

      <tr>
          <td style="width: 130px;" align="right">
            1.
          </td>
          <td align="left" style="width: 250px;">
            Death Entry Number
          </td>
          <td align="left">
            <%= @person[:death_entry_number] %>
          </td>
        </tr>
        <tr>
          <td style="width: 130px;" align="right">
            2.
          </td>
          <td align="left" style="width: 250px;">
            Registration Number
          </td>
          <td align="left">
            <%= @person[:death_registration_number]  %>
          </td>
        </tr
        <tr>
          <td style="width: 130px;" align="right">
            3.
          </td>
          <td align="left" style="width: 250px;">
            Name of Deceased
          </td>
          <td align="left">
            <%= @person[:first_name] %> <%= @person[:middle_name] %> <%= @person[:last_name] %>
          </td>
        </tr>
        <tr>
          <td style="width: 130px;" align="right">
            4.
          </td>
          <td align="left" style="width: 250px;">
            Date of Birth
          </td>
          <td align="left">
            <%= (!@person[:birthdate].blank? ? @person[:birthdate].to_date.day : "") %><sup
            style="font-size: 18px;"><%= (!@person[:birthdate].blank? ?
                  @person[:birthdate].to_date.day.ordinalize.match(/([a-z]+)/).captures.first : "") %></sup>
            <%= (!@person[:birthdate].blank? ? @person[:birthdate].to_date.strftime("%B, %Y") : "") %>
          </td>
        </tr>
        <tr>
          <td style="width: 130px;" align="right">
            5.
          </td>
          <td align="left" style="width: 250px;">
            Sex
          </td>
          <td align="left">
            <%= @person[:gender] %>
          </td>
        </tr>
        <tr>
          <td style="width: 130px;" align="right">
            6.
          </td>
          <td align="left" style="width: 250px;">
            Date of Death
          </td>
          <td align="left">
            <%= (!@person[:date_of_death].blank? ? @person[:date_of_death].to_date.day : "") %><sup
            style="font-size: 18px;"><%= (!@person[:date_of_death].blank? ?
                  @person[:date_of_death].to_date.day.ordinalize.match(/([a-z]+)/).captures.first : "") %></sup>
            <%= (!@person[:date_of_death].blank? ? @person[:date_of_death].to_date.strftime("%B, %Y") : "") %>
          </td>
        </tr>
        <tr>
          <td style="width: 130px;" align="right">
            7.
          </td>
          <td align="left" style="width: 250px;">
            Place of Death
          </td>
          <td align="left">
            <%
                place_of_death = ""

               case @person["place_of_death"]
                 when "Home(Place of residence)"
                    place_of_death = "#{@person["place_of_death_village"]}#{(!@person["place_of_death_village"].blank? ?
                            ", " : "")}#{@person["place_of_death_ta"]}#{(!@person["place_of_death_ta"].blank? ?
                            ", " : "")}#{@person["place_of_death_district"]}"

                 when "Hospital/Institution"
                    place_of_death = "#{@person["hospital_of_death_name"]}"

                 when "Other"
                    place_of_death = "#{@person["other_place_of_death"]} " + @person["place_of_death_district"]

                 end
            %>
            <%= place_of_death %>
          </td>
        </tr>
        <tr>
          <td style="width: 130px;" align="right">
            8.
          </td>
          <td align="left" style="width: 250px;">
            Name of Mother
          </td>
          <td align="left">
            <%= @person[:mother_first_name] %> <%= @person[:mother_middle_name] %> <%= @person[:mother_last_name] %>
          </td>
        </tr>
        <tr>
          <td style="width: 130px;" align="right">
            9.
          </td>
          <td align="left" style="width: 250px;">
            Name of Father
          </td>
          <td align="left">
            <%= @person[:father_first_name] %> <%= @person[:father_middle_name] %> <%= @person[:father_last_name] %>
          </td>
        </tr>
        <tr>
          <td style="width: 130px;" align="right">
            10.
          </td>
          <td align="left" style="width: 250px;">
            Date of Registration
          </td>
          <td align="left">
            <%= (!@person[:created_at].blank? ? @person[:created_at].to_date.day : "") %><sup
            style="font-size: 18px;"><%= (!@person[:created_at].blank? ?
                  @person[:created_at].to_date.day.ordinalize.match(/([a-z]+)/).captures.first : "") %></sup>
            <%= (!@person[:created_at].blank? ? @person[:created_at].to_date.strftime("%B, %Y") : "") %>
          </td>
        </tr>
    </table>
    </div>
    	
    <div id="signature">
      <img src ="data:image/png;base64,<%= @sig %>" width="120" height="50" align="right" style="padding-right: 40px;margin-right: 40px;" />
   </div>
 </div>  
</body>
</html>
