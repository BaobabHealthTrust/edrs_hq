<style>

    .dropdown.dropdown-lg .dropdown-menu {
        margin-top: -1px;
        padding: 6px 20px;
    }
    .input-group-btn .btn-group {
        display: flex !important;
    }
    .btn-group .btn {
        border-radius: 0;
        margin-left: -1px;
    }
    .btn-group .btn:last-child {
        border-top-right-radius: 4px;
        border-bottom-right-radius: 4px;
    }
    .btn-group .form-horizontal .btn[type="submit"] {
        border-top-left-radius: 4px;
        border-bottom-left-radius: 4px;
    }
    .form-horizontal .form-group {
        margin-left: 0;
        margin-right: 0;
    }
    .form-group .form-control:last-child {
        border-top-left-radius: 4px;
        border-bottom-left-radius: 4px;
    }

    @media screen and (min-width: 768px) {
        #adv-search, #adv-search2, #adv-search3{
            width: 150;
            margin: 5px auto;
        }
        .dropdown.dropdown-lg {
            position: static !important;
        }
        .dropdown.dropdown-lg .dropdown-menu {
            min-width: 350px;
        }
    }

    .radio {
        padding-left: 20px; margin: 25px;
        color: darkslategray}
    .radio label {
        display: inline-block;
        border-bottom: 1px dotted lightgray;
        position: relative;
        padding-left: 5px; }
    .radio label::before {
        content: "";
        display: inline-block;
        position: absolute;
        width: 17px;
        height: 17px;
        left: 0;
        margin-left: -20px;
        border: 1px solid #cccccc;
        border-radius: 50%;
        background-color: #fff;
        -webkit-transition: border 0.15s ease-in-out;
        -o-transition: border 0.15s ease-in-out;
        transition: border 0.15s ease-in-out; }
    .radio label::after {
        display: inline-block;
        position: absolute;
        content: " ";
        width: 11px;
        height: 11px;
        left: 3px;
        top: 3px;
        margin-left: -20px;
        border-radius: 50%;
        background-color: #555555;
        -webkit-transform: scale(0, 0);
        -ms-transform: scale(0, 0);
        -o-transform: scale(0, 0);
        transform: scale(0, 0);
        -webkit-transition: -webkit-transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
        -moz-transition: -moz-transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
        -o-transition: -o-transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
        transition: transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33); }
    .radio input[type="radio"] {
        opacity: 0; }
    .radio input[type="radio"]:focus + label::before {
        outline: thin dotted;
        outline: 5px auto -webkit-focus-ring-color;
        outline-offset: -2px; }
    .radio input[type="radio"]:checked + label::after {
        -webkit-transform: scale(1, 1);
        -ms-transform: scale(1, 1);
        -o-transform: scale(1, 1);
        transform: scale(1, 1); }
    .radio input[type="radio"]:disabled + label {
        opacity: 0.65; }
    .radio input[type="radio"]:disabled + label::before {
        cursor: not-allowed; }
    .radio.radio-inline {
        margin-top: 0; }

    .radio-primary input[type="radio"] + label::after {
        background-color: #428bca; }
    .radio-primary input[type="radio"]:checked + label::before {
        border-color: #428bca; }
    .radio-primary input[type="radio"]:checked + label::after {
        background-color: #428bca; }

    .custom{
        display: none;
        width: 60%;
    }


    .left-pane{
        border: 1px solid lightgray;
        padding: 5px;
        overflow-y: auto;
    }

    .left-pane td{
        width: 50%;
        border: 1px dotted #d3d3d3;
        font-weight: bold;
        color: darkslategray;
    }

    .data{
        text-align: left !important;
        font-style: italic;
        padding: 5px;
        font-weight: normal !important;
    }
    .details td{
        text-align: left;
        padding-left: 10px;
    }
</style>

<table class="table" style="background: white;height: 97%;width: 100%">
<tr class="" style="width: 100%">
<td class="" style="width: 45%;border: 1px solid gray;">
  <h3 style="margin-top: 0px;margin-bottom: 0px;border-bottom: 1px solid #d3d3d3;background: #f8f8ff;padding: 5px; width: 100%;text-align: center">Primary Record</h3>

  <table style=" width: 100%; padding-left: 0.5%;">
    <tr>
      <td style=" width: 32%;vertical-align: top;">
        <div class="left-pane" style=" width: 100%;height: 95%;">
          <table style="width: 100%;" class="table table-bordered table-condensed details">
            <tr>
              <td style="width: 40%;">

                First Name :
              </td>
              <td class="data">
                <%= @person.first_name %>
              </td>
            </tr>

            <tr>
              <td>
                Middle Name :
              </td>
              <td class="data">
                <%= @person.middle_name %>
              </td>
            </tr>

            <tr>
              <td >
                Last Name :
              </td>
              <td class="data">
                <%= @person.last_name %>
              </td>
            </tr>

            <tr>
              <td>
                Date of Birth :
              </td>
              <td class="data">
                <%= @person.birthdate.strftime("%d/%b/%Y")%>
              </td>
            </tr>

            <tr>
              <td>
                Sex :
              </td>
              <td class="data">
                <%= @person['gender']%>
              </td>
            </tr>

            <tr>
              <td>
                Date of Death :
              </td>
              <td class="data">
                <%= @person[:date_of_death].to_date.strftime("%d/%b/%Y") %>
              </td>
            </tr>
            <tr>
              <td >
                Hospital of Death :
              </td>
              <td class="data">
                <%=  HealthFacility.find(@person["hospital_of_death_id"]).name rescue nil%>
              </td>
            </tr>

            <tr>
              <td>
                Village of Death :
              </td>
              <td class="data">
                <%= Village.find(@person["place_of_death_village_id"]).name rescue nil %>
              </td>
            </tr>

            <tr>
              <td>
                TA of Death :
              </td>
              <td class="data">
                <%= TraditionalAuthority.find(@person["place_of_death_ta_id"]).name rescue nil %>
              </td>
            </tr>

            <tr>
              <td>
                District of Death :
              </td>
              <td class="data">
                <%=District.find(@person["place_of_death_district_id"]).name rescue nil%>
              </td>
            </tr>


            <tr>
              <td >
                Mother First Name :
              </td>
              <td class="data">
                <%= @person[:mother_first_name] %>
              </td>
            </tr>

            <tr>
              <td >
                Mother Middle Name :
              </td>
              <td class="data">
                <%= @person[:mother_middle_name] rescue nil%>
              </td>
            </tr>

            <tr>
              <td >
                Mother Last Name :
              </td>
              <td class="data">
                <%= @person[:mother_last_name] rescue nil%>
              </td>
            </tr>

            <tr>
              <td >
                Father First Name :
              </td>
              <td class="data">
                <%= @person[:father_first_name] rescue nil %>
              </td>
            </tr>

            <tr>
              <td >
                Father Middle Name :
              </td>
              <td class="data">
                <%= @person[:father_middle_name] rescue nil%>
              </td>
            </tr>

            <tr>
              <td >
                Father Last Name :
              </td>
              <td class="data">
                <%= @person[:father_last_name] rescue nil%>
              </td>
            </tr>

          </table>
        </div>
      </td>

    </tr>

  </table>

</td>

<td id = "input-td" class="" style="width: 55%; border: 1px solid gray; background: palevioletred">

  <h3 style="margin-top: 0px;margin-bottom: 0px;border-bottom: 1px solid #d3d3d3;background: #f8f8ff;padding: 5px; width: 100%;text-align: center">Duplicate Record(s)</h3>
      <span style="width: 100%; text-align: center;margin: 2px; padding-left: 43%;">
        <button class="btn btn-primary" onclick="previousDuplicate()" style="padding-top: 3px;padding-bottom: 3px;"> << </button>
        <button class="btn btn-primary" onclick="nextDuplicate()" style="padding-top: 3px;padding-bottom: 3px;"> >> </button>
        <span class="pull-right" id="label" style="padding-top: 3px;padding-bottom: 3px;"> 1 of <%= @duplicates.count %> </button>

      </span>

        <%@duplicates.each_with_index do |person, i|%>
      <table id="<%=i+1%>" class="duplicate" style="width: 100%; padding-left: 0.5%; display: <%= (i == 0) ? 'table' : 'none'%>">
        <tr>
          <td style=" width: 32%;vertical-align: top;">
            <div class="left-pane" style=" width: 100%;height: 95%;">
              <table style="width: 100%;" class="table table-bordered table-condensed details">
                <tr>
                  <td style="width: 40%;">

                    First Name :
                  </td>
                  <td class="data">
                    <%= person.first_name %>
                  </td>
                </tr>

                <tr>
                  <td>
                    Middle Name :
                  </td>
                  <td class="data">
                    <%= person.middle_name %>
                  </td>
                </tr>

                <tr>
                  <td >
                    Last Name :
                  </td>
                  <td class="data">
                    <%= person.last_name %>
                  </td>
                </tr>

                <tr>
                  <td>
                    Date of Birth :
                  </td>
                  <td class="data">
                    <%= person.birthdate.strftime("%d/%b/%Y")%>
                  </td>
                </tr>

                <tr>
                  <td>
                    Sex :
                  </td>
                  <td class="data">
                    <%= person['gender']%>
                  </td>
                </tr>

                <tr>
                  <td>
                    Date of Death :
                  </td>
                  <td class="data">
                    <%= person[:date_of_death].to_date.strftime("%d/%b/%Y") %>
                  </td>
                </tr>
                <tr>
                  <td >
                    Hospital of Death :
                  </td>
                  <td class="data">
                    <%= HealthFacility.find(person["hospital_of_death_id"]).name rescue nil %>
                  </td>
                </tr>

                <tr>
                  <td>
                    Village of Death :
                  </td>
                  <td class="data">
                    <%= Village.find(@person["place_of_death_village_id"]).name rescue nil %>
                  </td>
                </tr>

                <tr>
                  <td>
                    TA of Death :
                  </td>
                  <td class="data">
                    <%= TraditionalAuthority.find(@person["place_of_death_ta_id"]).name rescue nil %>
                  </td>
                </tr>

                <tr>
                  <td>
                    District of Death :
                  </td>
                  <td class="data">
                    <%=District.find(@person["place_of_death_district_id"]).name rescue nil%>
                  </td>
                </tr>


                <tr>
                  <td >
                    Mother First Name :
                  </td>
                  <td class="data">
                    <%= person[:mother_first_name] %>
                  </td>
                </tr>

                <tr>
                  <td >
                    Mother Middle Name :
                  </td>
                  <td class="data">
                    <%= person[:mother_middle_name] rescue nil%>
                  </td>
                </tr>

                <tr>
                  <td >
                    Mother Last Name :
                  </td>
                  <td class="data">
                    <%= person[:mother_last_name] rescue nil%>
                  </td>
                </tr>

                <tr>
                  <td >
                    Father First Name :
                  </td>
                  <td class="data">
                    <%= person[:father_first_name] rescue nil %>
                  </td>
                </tr>

                <tr>
                  <td >
                    Father Middle Name :
                  </td>
                  <td class="data">
                    <%= person[:father_middle_name] rescue nil%>
                  </td>
                </tr>

                <tr>
                  <td >
                    Father Last Name :
                  </td>
                  <td class="data">
                    <%= person[:father_last_name] rescue nil%>
                  </td>
                </tr>

              </table>
            </div>
          </td>

        </tr>

      </table>

<% end %>
</td>
</tr>
</table>

<%@next_state ={
        "Data Supervisor" => ["HQ CAN PRINT", "HQ DUPLICATE"],
        "Data Manager" => ["HQ PRINT", "HQ CONFIRMED DUPLICATE"]
}%>

<div class="table-container-footer" style="padding: 0px;margin-bottom: 0px;">
  <table class="table table-striped table-hover table-condensed table-bordered">
    <tfoot>
    <tr>
      <th colspan="2" style="padding-left: 10px !important;">
        <button type="button" class="btn btn-danger pull-right"onclick="ajaxChange('<%= @next_state[@current_user.role][1]%>')" > Confirm Duplicate </button>
        <button type="button" class="btn btn-success pull-right" onclick="ajaxChange('<%= @next_state[@current_user.role][0]%>')" > Not a Duplicate </button>
      </th>
    </tr>
   </tfoot>
  </table>
</div>

<style>
  .pull-right{
      margin-right: 15px !important;
  }
</style>
<script>
    function showControls(id){
        $(".custom").hide();
        $("#" + id).show();
    }

    function __$(id){
        return document.getElementById(id);
    }

    cur = 1;
    total = parseInt("<%= @duplicates.count%>");

    function nextDuplicate(){
        if(cur < total){
            cur += 1;
            $(".duplicate").hide();
            $("#" + cur).show();
            $("#label").html(cur + " of " + total);
        }
    }

    function previousDuplicate(){
        if(cur > 1){
            cur -= 1;
            $(".duplicate").hide();
            $("#" + cur).show();
            $("#label").html(cur + " of " + total);
        }
    }

    function ajaxChange(status){
        $.ajax({
            url: "/ajax_change_status?next_status=" + status + "&person_id=<%=params['person_id']%>",
            success: function(feedback){
                window.parent.location = "/";
            },
            error: function(error){
                alert("Something went wrong");
            }
        })
    }

</script>
